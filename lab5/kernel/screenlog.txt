exe /initramfs/test_fork
[FS] fs_find_node(): finding path /initramfs/test_fork
[FS] fs_find_node(): finding node: initramfs
[FS] lookup() iterating children: initramfs
[FS] fs_find_node(): finding node: test_fork
[FS] fs_find_node(): final node name test_fork copied.
[FS] initramfs: lookup() finding name: test_fork, length: 10
name name: ., length: 2
name name: file1.txt, length: 10
name name: lib, length: 4
name name: lib/fork.h, length: 11
name name: lib/fork.o, length: 11
name name: lib/fork.S, length: 11
name name: lib/getpid.h, length: 13
name name: lib/getpid.S, length: 13
name name: lib/uartread.h, length: 15
name name: lib/uartwrite.h, length: 16
name name: lib/uartwrite.o, length: 16
name name: lib/uartwrite.S, length: 16
name name: linker.ld, length: 10
name name: Makefile, length: 9
name name: start.o, length: 8
name name: start.S, length: 8
name name: testProgram, length: 12
name name: testProgram.elf, length: 16
name name: testProgram.o, length: 14
name name: testProgram.S, length: 14
name name: test_fork, length: 10
[FS] fs_find_node(): node found test_fork.
[MEMORY][TRACE] chunk slot allocated. index: 32767, offset: 3
[MEMORY][TRACE] allocating buddy for order: 1
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 32761
[MEMORY][TRACE] Allocating larger block. index: 32761, order: 2
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32763, order: 1
[FS] initramfs: read() reading file: test_fork
[MEMORY][TRACE] free chunk memory successfully, ptr:7fff060
Executing /initramfs/test_fork
[MEMORY][TRACE] allocating buddy for order: 4
[MEMORY][DEBUG] Found buddy, order: 4 Start frame: 245734
[MEMORY][TRACE] No need to find larger block. index: 245734, order: 4
[MEMORY][TRACE] allocating buddy for order: 4
[MEMORY][DEBUG] Found buddy, order: 5 Start frame: 32717
[MEMORY][TRACE] Allocating larger block. index: 32717, order: 5
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32733, order: 4
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 4 Start frame: 32733
[MEMORY][TRACE] Allocating larger block. index: 32733, order: 4
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32741, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32737, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 32737
[MEMORY][TRACE] No need to find larger block. index: 32737, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 3 Start frame: 32741
[MEMORY][TRACE] Allocating larger block. index: 32741, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32745, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 32745
[MEMORY][TRACE] No need to find larger block. index: 32745, order: 2
[TASK][TRACE] task allocated. pid = 2
program size: 152
current size: 152
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 5 Start frame: 68
[MEMORY][TRACE] Allocating larger block. index: 68, order: 5
[MEMORY][TRACE] Put redundant memory block back to free list. index: 84, order: 4
[MEMORY][TRACE] Put redundant memory block back to free list. index: 76, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 72, order: 2
[MMU][DEBUG] mmu map page start, task[2] v_addr: 0, page: 44000.
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 72
[MEMORY][TRACE] No need to find larger block. index: 72, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 3 Start frame: 76
[MEMORY][TRACE] Allocating larger block. index: 76, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 80, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 80
[MEMORY][TRACE] No need to find larger block. index: 80, order: 2
[MMU][DEBUG] mmu map page end.
program offset: 7ff9000
[TASK][DEBUG] task copying offset: 152
[TASK][DEBUG] Task copied. pid = 2
[TASK][TRACE] new task running. pid = 2
# exe /initramfs/test_fork
[FS] fs_find_node(): finding path /initramfs/test_fork
[FS] fs_find_node(): finding node: initramfs
[FS] lookup() iterating children: initramfs
[FS] fs_find_node(): finding node: test_fork
[FS] fs_find_node(): final node name test_fork copied.
[FS] initramfs: lookup() finding name: test_fork, length: 10
name name: ., length: 2
name name: file1.txt, length: 10
name name: lib, length: 4
name name: lib/fork.h, length: 11
name name: lib/fork.o, length: 11
name name: lib/fork.S, length: 11
name name: lib/getpid.h, length: 13
name name: lib/getpid.S, length: 13
name name: lib/uartread.h, length: 15
name name: lib/uartwrite.h, length: 16
name name: lib/uartwrite.o, length: 16
name name: lib/uartwrite.S, length: 16
name name: linker.ld, length: 10
name name: Makefile, length: 9
name name: start.o, length: 8
name name: start.S, length: 8
name name: testProgram, length: 12
name name: testProgram.elf, length: 16
name name: testProgram.o, length: 14
name name: testProgram.S, length: 14
name name: test_fork, length: 10
[FS] fs_find_node(): node found test_fork.
[MEMORY][TRACE] chunk slot allocated. index: 32767, offset: 3
[MEMORY][TRACE] allocating buddy for order: 1
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 32761
[MEMORY][TRACE] Allocating larger block. index: 32761, order: 2
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32763, order: 1
[FS] initramfs: read() reading file: test_fork
[MEMORY][TRACE] free chunk memory successfully, ptr:7fff060
Executing /initramfs/test_fork
[MEMORY][TRACE] allocating buddy for order: 4
[MEMORY][DEBUG] Found buddy, order: 4 Start frame: 245734
[MEMORY][TRACE] No need to find larger block. index: 245734, order: 4
[MEMORY][TRACE] allocating buddy for order: 4
[MEMORY][DEBUG] Found buddy, order: 5 Start frame: 32717
[MEMORY][TRACE] Allocating larger block. index: 32717, order: 5
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32733, order: 4
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 4 Start frame: 32733
[MEMORY][TRACE] Allocating larger block. index: 32733, order: 4
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32741, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32737, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 32737
[MEMORY][TRACE] No need to find larger block. index: 32737, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 3 Start frame: 32741
[MEMORY][TRACE] Allocating larger block. index: 32741, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 32745, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 32745
[MEMORY][TRACE] No need to find larger block. index: 32745, order: 2
[TASK][TRACE] task allocated. pid = 2
program size: 152
current size: 152
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 5 Start frame: 68
[MEMORY][TRACE] Allocating larger block. index: 68, order: 5
[MEMORY][TRACE] Put redundant memory block back to free list. index: 84, order: 4
[MEMORY][TRACE] Put redundant memory block back to free list. index: 76, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 72, order: 2
[MMU][DEBUG] mmu map page start, task[2] v_addr: 0, page: 44000.
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 72
[MEMORY][TRACE] No need to find larger block. index: 72, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 3 Start frame: 76
[MEMORY][TRACE] Allocating larger block. index: 76, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 80, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 80
[MEMORY][TRACE] No need to find larger block. index: 80, order: 2
[MMU][DEBUG] mmu map page end.
program offset: 7ff9000
[TASK][DEBUG] task copying offset: 152
[TASK][DEBUG] Task copied. pid = 2
[MEMORY][TRACE] buddy partner is not free. buddy: 32759
[MEMORY][TRACE] buddy free. index:32761, order: 1
[TASK][TRACE] new task running. pid = 2
[SYSCALL][TRACE] index: 4
[SYSCALL][TRACE] fork called pid = 2
[MEMORY][TRACE] allocating buddy for order: 4
[MEMORY][DEBUG] Found buddy, order: 4 Start frame: 84
[MEMORY][TRACE] No need to find larger block. index: 84, order: 4
[MEMORY][TRACE] allocating buddy for order: 4
[MEMORY][DEBUG] Found buddy, order: 6 Start frame: 245654
[MEMORY][TRACE] Allocating larger block. index: 245654, order: 6
[MEMORY][TRACE] Put redundant memory block back to free list. index: 245686, order: 5
[MEMORY][TRACE] Put redundant memory block back to free list. index: 245670, order: 4
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 4 Start frame: 245670
[MEMORY][TRACE] Allocating larger block. index: 245670, order: 4
[MEMORY][TRACE] Put redundant memory block back to free list. index: 245678, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 245674, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 245674
[MEMORY][TRACE] No need to find larger block. index: 245674, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 3 Start frame: 245678
[MEMORY][TRACE] Allocating larger block. index: 245678, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 245682, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 245682
[MEMORY][TRACE] No need to find larger block. index: 245682, order: 2
[TASK][TRACE] task allocated. pid = 3
[MMU][DEBUG] mmu map page start, task[3] v_addr: 0, page: 44000.
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 5 Start frame: 245686
[MEMORY][TRACE] Allocating larger block. index: 245686, order: 5
[MEMORY][TRACE] Put redundant memory block back to free list. index: 245702, order: 4
[MEMORY][TRACE] Put redundant memory block back to free list. index: 245694, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 245690, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 2 Start frame: 245690
[MEMORY][TRACE] No need to find larger block. index: 245690, order: 2
[MEMORY][TRACE] allocating buddy for order: 2
[MEMORY][DEBUG] Found buddy, order: 3 Start frame: 245694
[MEMORY][TRACE] Allocating larger block. index: 245694, order: 3
[MEMORY][TRACE] Put redundant memory block back to free list. index: 245698, order: 2
[MMU][DEBUG] mmu map page end.
[TASK][TRACE] new task running. pid = 3
[FORK] split pid: 2
[SYSCALL][TRACE] index: 2
is parent proc
[SYSCALL][TRACE] index: 5
[SYSCALL][EXIT] task exited with status: 0
[TASK][TRACE] task killed. pid = 2
# [MEMORY][TRACE] buddy partner is not free. buddy: 32729
[MEMORY][TRACE] buddy free. index:32733, order: 2
[MEMORY][TRACE] buddy partner is free and match start merging
[MEMORY][TRACE] buddy partner index: 32733, order: 2
[MEMORY][TRACE] buddy partner is not free. buddy: 32725
[MEMORY][TRACE] buddy free. index:32733, order: 3
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:32741, order: 2
[MEMORY][TRACE] buddy partner is free and match start merging
[MEMORY][TRACE] buddy partner index: 32741, order: 2
[MEMORY][TRACE] buddy partner is free and match start merging
[MEMORY][TRACE] buddy partner index: 32733, order: 3
[MEMORY][TRACE] buddy partner is not free. buddy: 32717
[MEMORY][TRACE] buddy free. index:32733, order: 4
[MEMORY][TRACE] buddy partner is not free. buddy: 76
[MEMORY][TRACE] buddy free. index:72, order: 2
[MEMORY][TRACE] buddy partner is free and match start merging
[MEMORY][TRACE] buddy partner index: 72, order: 2
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:72, order: 3
[MEMORY][TRACE] buddy partner is not free. buddy: 84
[MEMORY][TRACE] buddy free. index:80, order: 2
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:68, order: 2
[MMU][DEBUG] task[2] mm deleted.
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:32717, order: 4
[MEMORY][TRACE] buddy partner is not free. buddy: 245718
[MEMORY][TRACE] buddy free. index:245734, order: 4
[TASK][TRACE] task deleted. pid = 2
[FORK] split pid: 3
[SYSCALL][TRACE] index: 2
is child proc
[SYSCALL][TRACE] index: 5
[SYSCALL][EXIT] task exited with status: 0
[TASK][TRACE] task killed. pid = 3
[MEMORY][TRACE] buddy partner is not free. buddy: 245666
[MEMORY][TRACE] buddy free. index:245670, order: 2
[MEMORY][TRACE] buddy partner is free and match start merging
[MEMORY][TRACE] buddy partner index: 245670, order: 2
[MEMORY][TRACE] buddy partner is not free. buddy: 245662
[MEMORY][TRACE] buddy free. index:245670, order: 3
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:245678, order: 2
[MEMORY][TRACE] buddy partner is free and match start merging
[MEMORY][TRACE] buddy partner index: 245678, order: 2
[MEMORY][TRACE] buddy partner is free and match start merging
[MEMORY][TRACE] buddy partner index: 245670, order: 3
[MEMORY][TRACE] buddy partner is not free. buddy: 245654
[MEMORY][TRACE] buddy free. index:245670, order: 4
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:245686, order: 2
[MEMORY][TRACE] buddy partner is free and match start merging
[MEMORY][TRACE] buddy partner index: 245686, order: 2
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:245686, order: 3
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:245694, order: 2
[MEMORY][ERROR] This block already free. index: 68, order: 2
[MMU][DEBUG] task[3] mm deleted.
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:245654, order: 4
[MEMORY][TRACE] buddy partner is free but not the same order
[MEMORY][TRACE] buddy free. index:84, order: 4
[TASK][TRACE] task deleted. pid = 3
ps 
Current running task: 2
   1: task_a
   0: init
# 